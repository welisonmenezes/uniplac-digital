<!DOCTYPE html>
<html lang="pt-br">

<head>
    {% block head %}
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <meta content="{{ configuration.description }}" name="description">
    {% block title %}<title>- {{ configuration.name }}</title>{% endblock %}>

    {% block pagestyles %}
    <link rel="stylesheet" href="{{ url_for('static', filename='admin/vendors/mdi/css/materialdesignicons.min.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='admin/vendors/base/vendor.bundle.base.css') }}">
    <link rel="stylesheet"
    href="{{ url_for('static', filename='admin/vendors/datatables.net-bs4/dataTables.bootstrap4.css') }}">
    
    <!--Date picker-->
    <link rel="stylesheet" href="{{ url_for('static', filename='admin/css/datepicker.css') }}">

    <!-- rich editor froala -->
    <link rel="stylesheet" href="{{ url_for('static', filename='admin/vendors/froala/css/froala_editor.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='admin/vendors/froala/css/froala_style.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='admin/vendors/froala/css/plugins/code_view.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='admin/vendors/froala/css/plugins/draggable.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='admin/vendors/froala/css/plugins/colors.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='admin/vendors/froala/css/plugins/emoticons.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='admin/vendors/froala/css/plugins/image_manager.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='admin/vendors/froala/css/plugins/image.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='admin/vendors/froala/css/plugins/line_breaker.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='admin/vendors/froala/css/plugins/table.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='admin/vendors/froala/css/plugins/char_counter.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='admin/vendors/froala/css/plugins/video.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='admin/vendors/froala/css/plugins/fullscreen.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='admin/vendors/froala/css/plugins/file.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='admin/vendors/froala/css/plugins/quick_insert.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='admin/vendors/froala/css/plugins/help.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='admin/vendors/froala/css/third_party/spell_checker.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='admin/vendors/froala/css/plugins/special_characters.css') }}">
    <!-- end rich editor froala -->

    <link rel="stylesheet" href="{{ url_for('static', filename='admin/css/style.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='admin/css/custom.css') }}">
    <link rel="shortcut icon" href="{{ url_for('static', filename='admin/images/favicon.png') }}" />
    
    {% endblock %}

    {% endblock %}
</head>

<body>

    {% include "includes/admin/navbar.html" ignore missing %}

    <div class="container-fluid page-body-wrapper">

        {% include "includes/admin/navigation.html" ignore missing %}

        <div class="main-panel">
            <div class="content-wrapper">

                {% from "macros/messageFlash.html" import render_message %}
                {{ render_message() }}

                {% block content %}
                conteúdo aqui
                {% endblock content %}
            </div>
        </div>

    </div>

    <!-- Modal -->
    <div class="modal fade" id="modalMessages" tabindex="-1" role="dialog">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title"></h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Fechar">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body" id="modalMessageText"></div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Fechar</button>
                </div>
            </div>
        </div>
    </div>


    {% block scripts %}
    <script>
        var GLOBALS = {
            'BASE_URL': '{{request.url_root}}'
        };
    </script>
    <script src="{{ url_for('static', filename='admin/vendors/base/vendor.bundle.base.js') }}"></script>

    <!-- rich editor froala -->
    <script type="text/javascript" src="{{ url_for('static', filename='admin/vendors/froala/js/froala_editor.min.js') }}"></script>
    <script type="text/javascript" src="{{ url_for('static', filename='admin/vendors/froala/js/plugins/align.min.js') }}"></script>
    <script type="text/javascript" src="{{ url_for('static', filename='admin/vendors/froala/js/plugins/char_counter.min.js') }}"></script>
    <script type="text/javascript" src="{{ url_for('static', filename='admin/vendors/froala/js/plugins/code_beautifier.min.js') }}"></script>
    <script type="text/javascript" src="{{ url_for('static', filename='admin/vendors/froala/js/plugins/code_view.min.js') }}"></script>
    <script type="text/javascript" src="{{ url_for('static', filename='admin/vendors/froala/js/plugins/colors.min.js') }}"></script>
    <script type="text/javascript" src="{{ url_for('static', filename='admin/vendors/froala/js/plugins/draggable.min.js') }}"></script>
    <script type="text/javascript" src="{{ url_for('static', filename='admin/vendors/froala/js/plugins/emoticons.min.js') }}"></script>
    <script type="text/javascript" src="{{ url_for('static', filename='admin/vendors/froala/js/plugins/entities.min.js') }}"></script>
    <script type="text/javascript" src="{{ url_for('static', filename='admin/vendors/froala/js/plugins/file.min.js') }}"></script>
    <script type="text/javascript" src="{{ url_for('static', filename='admin/vendors/froala/js/plugins/font_size.min.js') }}"></script>
    <script type="text/javascript" src="{{ url_for('static', filename='admin/vendors/froala/js/plugins/font_family.min.js') }}"></script>
    <script type="text/javascript" src="{{ url_for('static', filename='admin/vendors/froala/js/plugins/fullscreen.min.js') }}"></script>
    <script type="text/javascript" src="{{ url_for('static', filename='admin/vendors/froala/js/plugins/image.min.js') }}"></script>
    <script type="text/javascript" src="{{ url_for('static', filename='admin/vendors/froala/js/plugins/image_manager.min.js') }}"></script>
    <script type="text/javascript" src="{{ url_for('static', filename='admin/vendors/froala/js/plugins/line_breaker.min.js') }}"></script>
    <script type="text/javascript" src="{{ url_for('static', filename='admin/vendors/froala/js/plugins/inline_style.min.js') }}"></script>
    <script type="text/javascript" src="{{ url_for('static', filename='admin/vendors/froala/js/plugins/link.min.js') }}"></script>
    <script type="text/javascript" src="{{ url_for('static', filename='admin/vendors/froala/js/plugins/lists.min.js') }}"></script>
    <script type="text/javascript" src="{{ url_for('static', filename='admin/vendors/froala/js/plugins/paragraph_format.min.js') }}"></script>
    <script type="text/javascript" src="{{ url_for('static', filename='admin/vendors/froala/js/plugins/paragraph_style.min.js') }}"></script>
    <script type="text/javascript" src="{{ url_for('static', filename='admin/vendors/froala/js/plugins/quick_insert.min.js') }}"></script>
    <script type="text/javascript" src="{{ url_for('static', filename='admin/vendors/froala/js/plugins/quote.min.js') }}"></script>
    <script type="text/javascript" src="{{ url_for('static', filename='admin/vendors/froala/js/plugins/table.min.js') }}"></script>
    <script type="text/javascript" src="{{ url_for('static', filename='admin/vendors/froala/js/plugins/save.min.js') }}"></script>
    <script type="text/javascript" src="{{ url_for('static', filename='admin/vendors/froala/js/plugins/url.min.js') }}"></script>
    <script type="text/javascript" src="{{ url_for('static', filename='admin/vendors/froala/js/plugins/video.min.js') }}"></script>
    <script type="text/javascript" src="{{ url_for('static', filename='admin/vendors/froala/js/plugins/help.min.js') }}"></script>
    <script type="text/javascript" src="{{ url_for('static', filename='admin/vendors/froala/js/plugins/print.min.js') }}"></script>
    <script type="text/javascript" src="{{ url_for('static', filename='admin/vendors/froala/js/third_party/spell_checker.min.js') }}"></script>
    <script type="text/javascript" src="{{ url_for('static', filename='admin/vendors/froala/js/plugins/special_characters.min.js') }}"></script>
    <script type="text/javascript" src="{{ url_for('static', filename='admin/vendors/froala/js/plugins/word_paste.min.js') }}"></script>
    
    <script>
        var contentArea = document.getElementById('content');
        if (contentArea) {
            FroalaEditor.DefineIcon('insert', {NAME: 'plus', SVG_KEY: 'insertImage'});
            FroalaEditor.RegisterCommand('insert', {
                title: 'Insert HTML',
                focus: true,
                undo: true,
                refreshAfterCallback: true,
                callback: function () {
                    $('#contentImageSender').click();
                }
            });
            var Editor = new FroalaEditor('#content', {
                toolbarButtons: [
                    ['bold', 'italic', 'underline', 'textColor'],
                    ['alignLeft', 'alignCenter', 'alignRight', 'alignJustify'],
                    ['formatUL', 'formatOL', 'paragraphFormat', 'insertTable'],
                    ['insertLink', 'insert', 'insertVideo', 'emoticons']
                ],
                quickInsertTags: []
            });
        }

        $('body').on('change', '#contentImageSender', function(evt) {
            sendImagem(evt);
        });

        // metodo de envio de imagem
        sendImagem = function(evt){
            var element = evt.target;
            var file = element.files[0];
            if (file && file.name) {
                var filename = file.name;
                var extension = filename.slice((filename.lastIndexOf('.') - 1 >>> 0) + 2).toLowerCase();
                var accepts = element.getAttribute('accept').split(',');
                if (file.size <= 5017969) {
                    if (accepts.indexOf('.' + extension) > -1) {
                        var reader = new FileReader();
                        reader.onloadend = () => {
                            fetch(GLOBALS.BASE_URL+'api/image', {
                                method: 'POST',
                                headers: {
                                    'Accept': 'application/json',
                                    'Content-Type': 'application/json'
                                },
                                body: JSON.stringify({ image: reader.result })
                            })
                                .then(data => data.json())
                                .then(data => {
                                    if (data && data.id) {
                                        Editor.image.insert(GLOBALS.BASE_URL+'api/media/'+data.id, true);
                                    } else {
                                        showFeedbackMessage(data.message);
                                    }
                                }, error => {
                                    showFeedbackMessage(error);
                                    element.value = null;
                                });
                        }
                        reader.readAsDataURL(file);
                    } else {
                        element.value = null;
                        showFeedbackMessage('Tipo de arquivo inválido. Apenas imagens é permitido');
                    }
                } else {
                    element.value = null;
                    showFeedbackMessage('A imagem não pode ser maior que 5mb');
                }
            }
        };

        showFeedbackMessage = function(text) {
            $('#modalMessageText').html(text);
            $('#modalMessages').modal('show');
        };
    </script>
    <!-- end rich editor froala -->

    <!--Date picker-->
    <!-- <script src="{{ url_for('static', filename='admin/js/jquery.js')}}"></script> -->
    <script src="{{ url_for('static', filename='admin/js/datepicker.js')}}"></script>

    <script src="{{ url_for('static', filename='admin/vendors/chart.js/Chart.min.js') }}"></script>
    <script src="{{ url_for('static', filename='admin/js/off-canvas.js') }}"></script>
    <script src="{{ url_for('static', filename='admin/js/hoverable-collapse.js') }}"></script>
    <script src="{{ url_for('static', filename='admin/js/template.js') }}"></script>
    <script src="{{ url_for('static', filename='admin/js/dashboard.js') }}"></script>
    <script src="{{ url_for('static', filename='admin/js/jquery.dataTables.js') }}"></script>
    <script src="{{ url_for('static', filename='admin/js/dataTables.bootstrap4.js') }}"></script>
    <script src="{{ url_for('static', filename='admin/js/vanilla-masker.min.js') }}"></script>
    <script src="{{ url_for('static', filename='admin/js/custom.js') }}"></script>
    <script src="{{ url_for('static', filename='admin/dist/vanilla-validator.concat.min.js') }}"></script>
    {% endblock %}

</body>

</html>